# Memoization with frozenset for immutable state

Use functools.cache with frozenset to memoize graph traversal in #Python ðŸ‘‡

```python
from functools import cache

def count_paths(graph: dict[str, list[str]],
                start: str,
                target: str,
                must_visit: set[str]) -> int:
    """Count paths that visit required nodes."""

    @cache
    def search(node: str, visited: frozenset[str]) -> int:
        # Update visited set if this is a required node
        if node in must_visit:
            visited = visited | {node}

        # Success: reached target with all required nodes
        if node == target:
            return int(must_visit.issubset(visited))

        # Recursively explore children
        return sum(search(child, visited) for child in graph[node])

    return search(start, frozenset())

# Example:
graph = {
    "A": ["B", "C"],
    "B": ["D"],
    "C": ["D"],
    "D": []
}

# Count paths from A to D that go through B
print(count_paths(graph, "A", "D", {"B"}))  # 1

# frozenset is:
# âœ“ Immutable (hashable for caching)
# âœ“ Perfect for visited/seen tracking
# âœ“ Supports set operations (|, &, -, etc.)
```

#caching #graphs
